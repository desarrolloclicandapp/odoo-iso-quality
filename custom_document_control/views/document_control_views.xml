<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="view_area_tree" model="ir.ui.view"><field name="name">area.list</field><field name="model">document.area</field><field name="arch" type="xml"><list editable="bottom"><field name="name"/><field name="code"/></list></field></record>
    <record id="act_area" model="ir.actions.act_window"><field name="name">Áreas</field><field name="res_model">document.area</field><field name="view_mode">list</field></record>

    <record id="view_cat_tree" model="ir.ui.view"><field name="name">cat.list</field><field name="model">document.category</field><field name="arch" type="xml"><list editable="bottom"><field name="name"/><field name="code"/></list></field></record>
    <record id="act_cat" model="ir.actions.act_window"><field name="name">Categorías</field><field name="res_model">document.category</field><field name="view_mode">list</field></record>

    <record id="view_type_tree" model="ir.ui.view"><field name="name">type.list</field><field name="model">document.type</field><field name="arch" type="xml"><list editable="bottom"><field name="name"/><field name="code"/></list></field></record>
    <record id="act_type" model="ir.actions.act_window"><field name="name">Tipos</field><field name="res_model">document.type</field><field name="view_mode">list</field></record>

    <record id="view_tag_tree" model="ir.ui.view"><field name="name">tag.list</field><field name="model">document.tag</field><field name="arch" type="xml"><list editable="bottom"><field name="name"/><field name="color" widget="color_picker"/></list></field></record>
    <record id="act_tag" model="ir.actions.act_window"><field name="name">Etiquetas</field><field name="res_model">document.tag</field><field name="view_mode">list</field></record>

    <record id="view_folder_form" model="ir.ui.view">
        <field name="name">folder.form</field>
        <field name="model">document.folder</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <div class="oe_title"><h1><field name="name"/></h1></div>
                    <group>
                        <field name="parent_id"/>
                        <field name="allowed_group_ids" widget="many2many_tags"/>
                    </group>
                    <notebook><page string="Subcarpetas"><field name="child_ids"><list><field name="name"/></list></field></page></notebook>
                </sheet>
            </form>
        </field>
    </record>
    <record id="act_folder" model="ir.actions.act_window"><field name="name">Carpetas</field><field name="res_model">document.folder</field><field name="view_mode">list,form</field></record>

    <record id="view_doc_form" model="ir.ui.view">
        <field name="name">doc.form</field>
        <field name="model">document.control</field>
        <field name="arch" type="xml">
            <form>
                <header>
                    <button name="action_start_flow" string="Generar Código" type="object" class="oe_highlight" invisible="state != 'draft'"/>
                    <button name="action_submit_review" string="Enviar a Revisión" type="object" class="oe_highlight" invisible="state != 'upload'"/>
                    <button name="action_review_pass" string="Visto Bueno" type="object" class="oe_highlight" invisible="state != 'review'"/>
                    <button name="action_approve" string="Aprobar Final" type="object" class="oe_highlight" invisible="state != 'validate'"/>
                    <button name="action_publish_direct" string="Publicar Directo" type="object" class="btn-success" invisible="state != 'upload'"/>
                    <button name="action_reject" string="Rechazar" type="object" class="btn-danger" invisible="state not in ('review', 'validate')"/>
                    <button name="action_create_minor_rev" string="Rev. Menor" type="object" invisible="state != 'approved' or active_revision_id"/>
                    <button name="action_create_major_rev" string="Rev. Mayor" type="object" invisible="state != 'approved' or active_revision_id"/>
                    <button name="action_open_preview_popup" string="Ver Archivo" type="object" class="btn-info"/>
                    <button name="action_view_certificate" string="Ver Certificado" type="object" invisible="state != 'approved'"/>
                    <field name="state" widget="statusbar" statusbar_visible="draft,upload,approved"/>
                </header>
                <sheet>
                    <h1><field name="code"/> v<field name="version"/></h1>
                    <h2><field name="name"/></h2>
                    <group>
                        <group><field name="area_id"/><field name="category_id"/><field name="type_id"/><field name="folder_id"/></group>
                        <group><field name="owner_id"/><field name="issue_date"/><field name="document_scope"/></group>
                    </group>
                    <notebook>
                        <page string="Archivos">
                            <group><field name="editable_file"/><field name="pdf_file"/></group>
                        </page>
                        <page string="Firmas"><group><field name="reviewer_ids" widget="many2many_tags"/><field name="approver_ids" widget="many2many_tags"/></group></page>
                        <page string="Historial"><field name="history_ids"><list><field name="version"/><field name="state"/><button name="action_open_from_list" type="object" icon="fa-external-link"/></list></field></page>
                    </notebook>
                </sheet>
                <div class="oe_chatter"><field name="message_follower_ids"/><field name="activity_ids"/><field name="message_ids"/></div>
            </form>
        </field>
    </record>

    <record id="view_doc_search" model="ir.ui.view">
        <field name="name">doc.search</field>
        <field name="model">document.control</field>
        <field name="arch" type="xml">
            <search>
                <field name="name"/><field name="code"/>
                <filter name="my" string="Mis Docs" domain="[('owner_id','=',uid)]"/>
                <searchpanel>
                    <field name="folder_id" icon="fa-folder" enable_counters="0" hierarchy="1"/>
                    <field name="state" icon="fa-filter" select="multi" enable_counters="1"/>
                </searchpanel>
            </search>
        </field>
    </record>

    <record id="act_doc" model="ir.actions.act_window"><field name="name">Documentos</field><field name="res_model">document.control</field><field name="view_mode">list,form</field></record>
</odoo>
